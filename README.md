# 智能变化检测系统全方位使用说明书

## 一、系统概述

智能变化检测系统是一款专业级动态变化识别工具，能够实时监测指定窗口或摄像头的画面变化，并智能标记变化区域。本系统广泛应用于安防监控、软件测试、自动化检测等多个领域。

## 二、系统特点

1. **多源监控**：支持窗口程序监控和摄像头监控两种模式
2. **智能识别**：自动识别画面中的变化区域并高亮显示
3. **参数可调**：可自定义检测灵敏度、最小变化区域等参数
4. **ROI选择**：支持选择感兴趣区域进行局部监控
5. **跨平台兼容**：支持Windows系统下各类应用程序窗口

## 三、系统要求

### 硬件要求
- 处理器：Intel Core i3或同等性能以上
- 内存：4GB以上
- 显卡：支持OpenCV硬件加速
- 摄像头（如使用摄像头监控模式）

### 软件要求
- 操作系统：Windows 7/10/11
- Python 3.6+
- OpenCV库
- MSS库
- pywin32库
- psutil库

## 四、安装指南

1. 安装Python 3.6或更高版本
2. 安装依赖库：
   ```
   pip install opencv-python mss pywin32 psutil
   ```
3. 下载本程序文件`real_time_detection.py`
4. 运行程序：
   ```
   python real_time_detection.py
   ```

## 五、功能详解

### 1. 主控制面板

![控制面板界面](控制面板示意图)

控制面板包含以下主要区域：

- **监控源选择**：选择监控进程或摄像头
- **显示控制**：调整结果显示窗口
- **检测参数设置**：配置检测参数
- **状态栏**：显示系统状态

### 2. 监控模式

#### 2.1 窗口程序监控

1. 点击"选择监控进程"按钮
2. 在弹出的窗口列表中选择目标程序
3. 系统将开始监控该窗口的画面变化
4. 变化区域将以绿色矩形框标记

#### 2.2 摄像头监控

1. 点击"选择镜头监控"按钮
2. 在弹出的摄像头列表中选择可用摄像头
3. 系统将开始监控摄像头画面
4. 变化区域将以绿色矩形框标记

### 3. 参数设置

#### 3.1 帧率(FPS)

- **作用**：控制检测频率
- **范围**：1-120帧/秒
- **调整方式**：
  - 拖动滑块调整
  - 直接在输入框中输入数值后按回车

#### 3.2 变化阈值

- **作用**：控制变化检测的敏感度
- **范围**：1-100（值越小越敏感）
- **调整方式**：
  - 拖动滑块调整
  - 直接在输入框中输入数值后按回车

#### 3.3 最小区域

- **作用**：设置被识别为变化的最小区域面积
- **范围**：1-1000像素
- **调整方式**：
  - 拖动滑块调整
  - 直接在输入框中输入数值后按回车

### 4. 显示控制

#### 4.1 ROI区域选择

1. 在结果窗口中按住鼠标左键拖动选择区域
2. 释放鼠标后，系统将只监控选定区域
3. 右键点击可取消ROI选择

#### 4.2 重置显示区域

- 点击"重置显示区域"按钮可取消ROI选择

#### 4.3 调整窗口大小

- 点击"调整窗口大小"按钮将结果窗口重置为默认大小

### 5. 高级功能

#### 5.1 置顶显示

- 勾选"置顶结果面板"可使结果窗口保持在最上层

#### 5.2 控制面板大小调整

- 勾选"可调整面板大小"可允许调整控制面板窗口尺寸

## 六、应用场景

### 1. 安防监控

- 监控特定区域的异常活动
- 检测入侵行为

### 2. 软件测试

- 自动化测试UI变化
- 检测程序界面异常

### 3. 工业检测

- 生产线产品质量检测
- 设备运行状态监控

### 4. 科研实验

- 记录实验过程变化
- 分析动态过程

## 七、常见问题解答

### Q1: 为什么检测不到变化？

A: 可能原因：
- 变化阈值设置过高
- 最小区域设置过大
- 监控区域选择不当

### Q2: 如何提高检测精度？

A: 建议：
- 降低变化阈值
- 减小最小区域设置
- 选择更精确的ROI区域

### Q3: 系统占用资源过高怎么办？

A: 可尝试：
- 降低帧率设置
- 选择更小的监控区域
- 关闭不必要的应用程序

### Q4: 如何保存检测结果？

A: 当前版本暂不支持自动保存功能，可使用截图工具手动保存结果窗口内容。

## 八、注意事项

1. 请确保监控行为符合当地法律法规
2. 长时间监控可能占用较多系统资源
3. 摄像头监控模式下请确保摄像头正常工作
4. 窗口监控模式下请确保目标窗口不被其他窗口遮挡

## 九、版本更新说明

### 当前版本：v33

更新内容：
- 优化了线程管理机制
- 增加了ROI区域选择功能
- 改善了参数调整的实时性
- 修复了若干已知问题

## 十、技术支持

如需技术支持或功能建议，请联系开发者。

---

本说明书适用于智能变化检测系统v33版本，内容可能随版本更新而调整。
